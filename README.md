# Coding Practice Environment

A structured environment for practicing algorithm problems (BOJ, Codeforces, LeetCode, etc.) with a custom automated test runner and problem parser.

## Directory Structure

```text
CodingPractice/
├── problems/
│   ├── acmicpc/       # Previously BOJ
│   │   └── 1000/
│   │       ├── data/          # Test cases (in/out)
│   │       ├── solution.cpp   # Your solution
│   │       └── README.md      # Problem description & limits
│   ├── codeforces/
│   └── leetcode/      # (Optional)
├── runner/
│   ├── resources/
│   │   ├── cookies/   # Site-specific session cookies (.json)
│   │   └── ...
│   ├── src/
│   │   ├── lib.rs         # Core logic library (Common functions)
│   │   └── bin/
│   │       ├── runner.rs      # Test suite runner (Uses lib.rs)
│   │       ├── add_problem.rs # Problem creation tool
│   │       ├── cptest.rs      # Single case debugger (Uses lib.rs)
│   │       ├── solution_proxy.rs # Temporary proxy for Cargo compilation
│   │       └── parse/         # Parsing logic (main.rs, crawl.rs, etc.)
│   ├── templates/     # Code & README templates
│   └── Cargo.toml
├── bin/               # Compiled binaries
│   ├── runner
│   ├── add_problem
│   └── cptest
└── README.md
```

## Features

- **Integrated Problem Generator**: 
  - **Manual Input**: Create templates and input test cases manually.
  - **URL Parsing**: Automatically fetch problem titles, descriptions, constraints, and test cases from supported sites (currently **Codeforces**).
- **Automated Suite Testing**: The `runner` tool automatically compiles a solution and runs it against all associated test cases.
- **Smart Compilation**:
  - Supports **Rust Toolchain Locking**: Defaults to **Rust 1.89.0** via `rustup` for consistent environment.
  - Supports **In-file Directives**: Control compiler behavior directly in your source code.
  - **Auto Cleanup**: Automatically removes `long-type-*.txt` files generated by the Rust compiler.
- **Bypass Cloudflare**: Supports both Cookie-based and CDP-based (Chromium DevTools Protocol) fetching to handle protected sites.
- **Smart Path Detection**: Run tools from any subdirectory; they automatically find the project root.

## Codeforces Math Rendering

To view the problem `README.md` (generated by `add_problem`) exactly as it appears on the Codeforces website, you should use the **Markdown Preview Enhanced** extension in VS Code.

1.  Install the **Markdown Preview Enhanced** extension.
2.  Open VS Code Settings (`Ctrl + ,`).
3.  Search for `Markdown-preview-enhanced: Math Rendering Option`.
4.  Change the setting from `KaTeX` to **`MathJax`**.

**Why?** The built-in VS Code Markdown preview uses KaTeX for math rendering and does not allow switching the engine. Some Codeforces-specific LaTeX syntax (like nested `\mathtt` and `\mathbf`) requires MathJax to render correctly.

## Environment & Requirements

### Project Criteria

1.  **Multiple Solution Support**: Support various language solutions (C++, Rust) for a single problem side-by-side.
2.  **Test Case Separation**: Keep test data (`.in`/`.out`) separate from source code in a `data/` subdirectory.
3.  **Automated Runner**: One-command automation to compile and test solutions.
4.  **Structured Hierarchy**: `problems/{site}/{problem_id}` structure (all lowercase) for organized practice.

## Get Started

### 1. Prerequisite

Ensure you have Rust, `rustup`, and Chromium (for CDP fetching) installed.
The environment uses **Rust 1.89.0** as the primary toolchain for algorithm practice.

```bash
# Install rustup
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
# The tools will automatically install required toolchains (1.89.0, nightly) via rustup.
```

### 2. Build and Install Tools

```bash
cd runner
cargo build --release
cp target/release/runner ../bin/
cp target/release/add_problem ../bin/
cp target/release/cptest ../bin/
cd ..
```

### 3. Configure Session Cookies (Optional)

To parse problems from sites requiring login (or to bypass certain checks), place exported cookies in `runner/resources/cookies/{site}.json`.
- Supported site names: `codeforces`, `acmicpc`, `leetcode`.

## Adding a New Problem

Use the integrated `add_problem` tool:

```bash
add_problem
```

1. **Select Input Method**: 
   - `Manual Input`: Traditional manual setup.
   - `Parse from URL`: Provide a URL (e.g., Codeforces) to automate everything.
2. **Automatic Setup**: If using URL, the tool will:
   - Create the directory: `problems/{site}/{id}/`
   - Create `solution.rs` and `solution.cpp` from templates.
   - Generate `README.md` with the problem statement.
   - Save sample test cases to the `data/` folder.

## Running Tests with `runner`

```bash
runner problems/acmicpc/1000/solution.cpp
```

### Features

-   **Automatic Compilation**: 
    - **C++**: uses `g++` with `-std=c++23`, `-O2`, and color output.
    - **Rust**: uses `rustup run 1.89.0 rustc` by default.
-   **In-file Directives**: Add these to the **top 2 lines** of your `.rs` file to override default behavior:
    - `// compiler: cargo`: Compiles using `cargo build` (useful for external crates like `itertools`).
    - `// toolchain: nightly`: Uses the `nightly` toolchain.
    - **Default (No options)**: If no directives are provided, the environment defaults to **`Compiler: rustc`** and **`Toolchain: 1.89.0`**.
-   **Output Verification**: Accurate comparison between solution output and `.out` files.
-   **Color Support**: Compilation and runtime errors maintain their original colors for better debugging.

## Testing a Single Case

```bash
# Usage: cptest <testcase_id> <path_to_solution_file>
cptest 1 problems/acmicpc/1000/solution.rs
```
